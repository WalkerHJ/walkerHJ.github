/*!
 * Copyright 2017, - using jQuery, contributors. liuhuajun
 *
 * Date: 2017-06- ~
 */
(function($){
	//弹出层
	function popups(opt){
		this._defaults={
			'popup_Text': 'title',
			'openEle_center':'center-text',
			'width':'500px',
			'height':'200px',
			'masking':false,//是否需要蒙版
			'location':'',//文本路径地址
			'openEle_center_select':0,//选择传入为text还是html(0为text 1为html)
			'openEle_center_tag':'<div>center-html</div>',
		},
		this.options=$.extend({},this._defaults,opt)
	}
	popups.prototype={
		//添加Dom元素
		open:function(){
			var openEle='<div class="openEle-Box">'+
							'<div class="openEle-content">'+
								'<div class="openEle-titlt">'+
									'<div class="openEle-titlt-text"></div>'+
									'<i class="iconfont icon-cuowu openEle-titlt-ioc"></i>'+
								'</div>'+
								'<div class="openEle-center"></div>'+
								'<div class="openEle-bottom">'+
									'<button class="zeromodal-btn zeromodal-btn-primary">确定</button>'+
									'<button class="zeromodal-btn zeromodal-btn-default">关闭</button>'+
								'</div>'+
							'</div>'+
						'</div>'+
						'<div class="openEle-mb"></div>'
			return $("body").prepend(openEle);
		},
		//Dom元素高宽属性
		beautify:function(){
			//获取opt宽度 高度动态计算值
			// var marginW_str=this.options.width;
			// var marginW = (marginW_str.split("px").join(""))/1.8;
			// var marginH_str=this.options.height;
			// var marginH = (marginH_str.split("px").join(""))/1.85;
			$('.openEle-Box').css({
	            'width': this.options.width,
	            'height': this.options.height,
			})
			//内容高度设置
			var ob_height=$('.openEle-Box').height();
			var ot_height=$('.openEle-titlt').height();
			var om_height=$('.openEle-bottom').height();
			$('.openEle-center').css({
				'height':ob_height-(ot_height+om_height)+'px'
			})
		},
		//Dom元素内容
		beautifyText:function(){
			//标题
			$('.openEle-titlt-text').text(this.options.popup_Text);
			//选择传入为text还是html(0为text1为html)
			if(this.options.openEle_center_select==0){
				//前台location非空时添加a标签
				if(this.options.location!=null&&this.options.location!=undefined&&this.options.location!=''){
					$('.openEle-center').prepend($('<a href='+this.options.location+'></a>').text(this.options.openEle_center))
				}else{
					$('.openEle-center').text(this.options.openEle_center);
				}
			}else if(this.options.openEle_center_select==1){
				$('.openEle-center').prepend(this.options.openEle_center_tag);
			}
		},
		//关闭
		close:function(){
			$('.zeromodal-btn,.openEle-titlt-ioc,.openEle-mb').click(function(){
				_close();                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
			});
		   document.onkeydown=function(event){
	       		var e = event || window.event || arguments.callee.caller.arguments[0];
	       		//ESC
	             if(e && e.keyCode==27){ 
	                	_close();
	               }
		    };
		    function _close(){
					$('.openEle-Box').css({
						'animation':'popup-close .3s'
					});
					setTimeout(function () {
						$('.openEle-Box').remove();
						$('.openEle-mb').remove();
					}, 50);     
				}        
		},
		//遮罩层masking
		masking:function(){
			if(this.options.masking==true){
				$('.openEle-mb').css({'opacity':'0.5'})
			}
		},
		//确认回调
		yesbind:function(callback){//callback==function yes(){}
			var isclick=false;
			$(".zeromodal-btn-primary").click(function(){
				isclick=true;
				if(isclick){
					callback();
				}
			})
		},
		//非确认回调
		nobind:function(callback){//callback==function no(){}
			var isclick=false;
			$(".zeromodal-btn-default").click(function(){
				isclick=true;
				if(isclick){
					callback();
				}
			})
		},
	}
	$.fn.popup=function(options){
		var popups_entity=new popups(options);
		return {
			open:popups_entity.open(),
			beautify:popups_entity.beautify(),
			beautifyText:popups_entity.beautifyText(),
			close:popups_entity.close(),
			masking:popups_entity.masking(),
			yesbind:popups_entity.yesbind(options.yes),//前台把yes函数作为参数 传值
			nobind:popups_entity.nobind(options.no),//前台把no函数作为参数 传值
		}
	}

	//询问层
	function confirm(opt){
		this._defaults={
			'popup_Text': 'title',
			'openEle_center':'center-text',
			'masking':false,//是否需要蒙版
		},
		this.options=$.extend({},this._defaults,opt)
	}
	confirm.prototype={
		//添加Dom元素
		open:function(){
			var openEle='<div class="openEle-modal-Box" id="openEle-modal-Box">'+
							'<div class="openEle-modal-content">'+
								'<div class="openEle-modal">'+
									'<div class="openEle-modal-titlt">'+
										'<div class="openEle-titlt-text"></div>'+
										'<i class="iconfont icon-cuowu openEle-titlt-ioc"></i>'+
									'</div>'+
									'<div class="openEle-modal-center"></div>'+
									'<div class="openEle-modal-bottom">'+
										'<button class="zeromodal-btn zeromodal-btn-primary">确定</button>'+
										'<button class="zeromodal-btn zeromodal-btn-default">关闭</button>'+
									'</div>'+
								'</div>'+
							'</div>'+
						'</div>'+
						'<div class="openEle-mb"></div>'
			$("body").prepend(openEle);
		},
		//Dom元素内容
		beautifyText:function(){
			//标题
			$('.openEle-titlt-text').text(this.options.popup_Text);
			//内容
			$('.openEle-modal-center').text(this.options.openEle_center);
		},
		//Dom元素高宽属性
		beautify:function(){
			//计算元素高宽设置居中
			// var _width=$('.openEle-modal-center').width();
			// var _height=$('.openEle-modal').height();
			// var _width_m=-(_width/2);
			// var _height_m=-(_height/2);
			// $('.openEle-modal-Box').css({'width':_width,'height':_height,'margin-left':_width_m+'px','margin-top':_height_m+'px'})
			var _width=$('.openEle-modal-Box').width();
			var _height=$('.openEle-modal-Box').height();
		},
		//关闭
		close:function(){
			$('.zeromodal-btn,.openEle-titlt-ioc,.openEle-modal-Box').click(function(){
				_close();                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
			});
			$(".openEle-modal-content").click(function(event){
			    event.stopPropagation();//阻止事件冒泡避免影响父元素
			});

		   document.onkeydown=function(event){
	       		var e = event || window.event || arguments.callee.caller.arguments[0];
	       		//ESC
	             if(e && e.keyCode==27){ 
	                	_close();
	               }
		    };
		    function _close(){
					$('.openEle-modal-Box').css({
						'animation':'linearUp .5s'
					});
					setTimeout(function () {
						$('.openEle-modal-Box').remove();
						$('.openEle-mb').remove();
					}, 200);     
				}        
		},
		//遮罩层masking
		masking:function(){
			if(this.options.masking==true){
				$('.openEle-mb').css({'opacity':'0.5'})
			}
		},

	}
	$.fn.confirm=function(options){
		var confirm_entity=new confirm(options);
		return {
			open:confirm_entity.open(),
			beautify:confirm_entity.beautify(),
			beautifyText:confirm_entity.beautifyText(),
			close:confirm_entity.close(),
			masking:confirm_entity.masking(),
		}
	}



	//msg对话框
	function msg(opt){
		this._defaults={
			'text': '自定义文字',
			'time':2,
		},
		this.options=$.extend({},this._defaults,opt)
	}
	msg.prototype={
		open:function(){
			//防止连续点击清除原有的DOM元素
			$('.openEle-msg').remove();
			var openEle='<div class="openEle-msg">'+
							'<p class="msg-content"></p>'+
						'</div>'
			return $("body").prepend(openEle);
		},
		beautifyText:function(){
			return $(".msg-content").text(this.options.text);
		},
		beautify:function(){
			//计算元素高宽设置居中
			var _width=$('.openEle-msg').width();
			var _height=$('.openEle-msg').height();
			var _width_m=-(_width/2);
			var _height_m=-(_height/2);
			$('.openEle-msg').css({'width':_width,'height':_height,'margin-left':_width_m+'px','margin-top':_height_m+'px'})
		},
		settime:function(){
			setTimeout(function(){
				$('.openEle-msg').css({
						'animation':'msg-close .1s'
					});
			},this.options.time*1000)
			setTimeout(function(){
				$('.openEle-msg').remove();
			},(this.options.time*1000)+50)
		}
	}
	$.fn.msgopen=function(options){
		var msgopen=new msg(options);
		return{
			open:msgopen.open(),
			//注:beautify必须置于beautifyText后，才能获取DOM元素高宽
			beautifyText:msgopen.beautifyText(),
			beautify:msgopen.beautify(),
			settime:msgopen.settime(),
		}
	}


})(window.jQuery)